> 📚 본 포스팅은 책 `모던 자바 인 액션(한빛미디어)'을 읽으며 정리한 글입니다.

<br>

### 실습에 사용되는 소스

```java
// 요리 리스트
public class Menu {
    List<Dish> menu = Arrays.asList(
            new Dish("pork", false, 800, Dish.Type.MEAT),
            new Dish("beef", false, 700, Dish.Type.MEAT),
            new Dish("chicken", false,400, Dish.Type.MEAT),
            new Dish("french fries",true, 530, Dish.Type.OTHER),
            new Dish("rice", true, 350, Dish.Type.OTHER),
            new Dish("season fruit", true, 120, Dish.Type.OTHER),
            new Dish("pizza", true, 550, Dish.Type.OTHER),
            new Dish("prawns", false, 300, Dish.Type.FISH),
            new Dish("salmon", false, 450, Dish.Type.FISH)
    );
}
```

```java
public class Dish {
    private final String name;
    private final boolean vegetarian;
    private final int calories;
    private final Type type;

    public Dish(String name, boolean vegetarian, int calories, Type type) {
        this.name = name;
        this.vegetarian = vegetarian;
        this.calories = calories;
        this.type = type;
    }

    public String getName() {
        return name;
    }

    public boolean isVegetarian() {
        return vegetarian;
    }

    public int getCalories() {
        return calories;
    }

    public Type getType() {
        return type;
    }

    @Override
    public String toString() {
        return name;
    }

    public enum Type {MEAT, FISH, OTHER}
}
```

<br>

# 5.1 필터링

## 5.1.1 프레디케이트(Predicate\<T\>)로 필터링

```java
// 모든 채식요리를 필터링해서 채식 메뉴를 만든다.
List<Dish> vegeterianMenu = menu.stream()
        .filter(Dish::isVegetarian)
        .collect(toList());
```

- `filter` 메서드는 `프레디케이트`를 인수로 받아서 프레디케이트와 
일치하는 모든 요소를 포함하는 스트림을 반환한다. 

<br>

## 5.1.2 고유 요소 필터링

```java
// 모든 짝수를 선택하고 중복을 필터링
List<Integer> numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4);
numbers.stream()
        .filter(i -> i % 2 == 0)
        .distinct()
        .forEach(System.out::println);
```

- 스트림은 고유 요소로 이루어진(요소의 중복이 없는) 스트림을 반환하는 
`distinct` 메서드도 지원한다.

<br>

# 5.2 스트림 슬라이싱

## 5.2.1 프레디케이트를 이용한 슬라이싱

자바 9부터 스트림의 요소를 효과적으로 선택할 수 있는 `takeWhile`, `dropWhile`
메서드를 지원한다. 

<br>

### TAKEWHILE 활용

여기, 아래와 같이 칼로리 기준 오름차순으로 정렬된 특별한 요리 목록이 있다. 

```java
List<Dish> specialMenu = Arrays.asList(
        new Dish("season fruit", true, 120, Dish.Type.OTHER),
        new Dish("prawns", false, 300, Dish.Type.FISH),
        new Dish("rice", true, 350, Dish.Type.OTHER),
        new Dish("chicken", false, 400, Dish.Type.MEAT),
        new Dish("french fries", true, 530, Dish.Type.OTHER)
);
```

<br>

위 리스트에서 어떻게 하면 '320칼로리 이하의 요리'만 선택할 수 있을까? 
우리는 앞서 `filter` 메서드의 사용법을 배웠으니 
아래와 같이 코드를 작성해볼 수 있을 것이다.

```java
List<Dish> filteredMenu = specialMenu.stream()
        .filter(dish -> dish.getCalories() < 320)
        .collect(toList()); // sesonal fruit, prawns 목록
```

<br>

원하는 결과를 얻을 수 있었다. 하지만 이미 
'리스트가 칼로리를 기준으로 오름차순으로 정렬되어있다.' 라는 사실을 알고있음에도
불구하고 전체 스트림을 반복하며 각 요소에 프레디케이트를 적용하게 되었고, 
이는 비효율적 연산이었음을 알 수 있다. `takeWhile` 연산을 이용하면 
이를 간단하게 해결할 수 있다. 아래의 소스는 320칼로리와 같거나 큰 요소를 만나면
반복작업을 그 즉시 중단한다.

```java
List<Dish> slicedMenu1 = specialMenu.stream()
        .takeWhile(dish -> dish.getCalories() < 320)
        .collect(toList()); // sesonal fruit, prawns 목록
```

<br>

### DROPWHILE 활용

나머지 요소를 선택하고자 하면 `dropWhile` 메서드를 사용하면 된다.

```java
List<Dish> slicedMenu2 = specialMenu.stream()
        .dropWhile(dish -> dish.getCalories() < 320)
        .collect(toList()); // rice, chicken, french fries 목록
```

`dropWhile` 은 `takeWhile`과 정반대의 작업을 한다. `dropWhile` 은 
프레디케이트가 거짓이 되는 지점까지 발견한 요소를 버리고, 나머지 요소를
스트림으로 반환한다.

<br>

### 퀴즈 5-1 필터링
Q. 스트림을 이용해서 처음 등장하는 두 고기 요리를 필터링 하시오.


```java
List<Dish> firstTwoBeefDishes = new Menu().menu.stream()
        .filter(dish -> dish.getType() == Dish.Type.MEAT)
        .limit(2)
        .collect(Collectors.toList());
```